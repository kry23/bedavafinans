/* BedavaFinans Internationalization - TR (default) / EN */

const TRANSLATIONS = {
    tr: {
        // Header
        'last-update': 'Son:',
        'auto': 'Oto',
        'paused': 'Durduruldu',

        // Market Overview Cards
        'total-market-cap': 'Toplam Piyasa Değeri',
        '24h-volume': '24s Hacim',
        'btc-dominance-label': 'BTC Hakimiyeti',
        'fear-greed-label': 'Korku & Açgözlülük',

        // Signal Table
        'trading-signals': 'İşlem Sinyalleri (Top 15)',
        '4-layer': '4 Katmanlı Bileşik',
        'th-coin': 'Coin',
        'th-price': 'Fiyat',
        'th-24h': '24s',
        'th-signal': 'Sinyal',
        'th-score': 'Skor',
        'th-rsi': 'RSI',
        'th-layers': 'Katmanlar',
        'loading-signals': 'Sinyaller yükleniyor...',

        // Derivatives
        'derivatives': 'Türev Piyasalar',
        'th-symbol': 'Sembol',
        'th-funding': 'Fonlama',
        'th-ls': 'U/K',
        'th-oi': 'AK',

        // Chart
        'chart-legend-ema9': 'EMA 9',
        'chart-legend-ema21': 'EMA 21',
        'chart-legend-bb': 'BB',

        // Top Movers
        'top-movers': 'En Çok Değişenler',
        'gainers': 'Yükselenler',
        'losers': 'Düşenler',

        // Volume Anomalies
        'volume-anomalies': 'Hacim Anomalileri',
        'no-anomalies': 'Anomali tespit edilmedi',

        // News Sentiment
        'news-sentiment': 'Haber Duygusu',

        // Coin Table
        'all-coins': 'Tüm Coinler (Top 50)',
        'search-placeholder': 'Coin ara...',
        'th-rank': '#',
        'th-1h': '1s',
        'th-7d': '7g',
        'th-7d-chart': '7g Grafik',
        'th-volume': 'Hacim',
        'th-market-cap': 'Piyasa Değeri',
        'loading-coins': 'Coinler yükleniyor...',

        // Footer
        'footer-text': 'BedavaFinans Sinyal Paneli',
        'footer-data': 'Veri:',
        'footer-refresh': 'Otomatik yenileme: 2 dk',

        // Signals
        'strong-buy': 'GÜÇLÜ AL',
        'buy': 'AL',
        'neutral': 'NÖTR',
        'sell': 'SAT',
        'strong-sell': 'GÜÇLÜ SAT',
        'no-data': 'VERİ YOK',

        // Confidence
        'high': 'Yüksek',
        'medium': 'Orta',
        'low': 'Düşük',

        // Sentiment labels
        'bullish': 'Yükseliş',
        'slightly-bullish': 'Hafif Yükseliş',
        'neutral-sent': 'Nötr',
        'slightly-bearish': 'Hafif Düşüş',
        'bearish': 'Düşüş',

        // Fear & Greed classifications
        'extreme-fear': 'Aşırı Korku',
        'fear': 'Korku',
        'neutral-fg': 'Nötr',
        'greed': 'Açgözlülük',
        'extreme-greed': 'Aşırı Açgözlülük',

        // Market Score
        'very-bullish': 'Çok Yükseliş',
        'very-bearish': 'Çok Düşüş',

        // Watchlist
        'watchlist': 'Favoriler',
        'watchlist-filter-title': 'Favorileri filtrele',

        // Whale
        'whale-loading': 'Balina verisi yükleniyor...',

        // Theme
        'toggle-theme': 'Tema değiştir',

        // Toast / Alerts
        'data-refreshed': 'Veriler guncellendi',
        'refresh-error': 'Yenileme hatasi',
        'alert-prompt': 'Hedef fiyat girin ($):',

        // General
        'loading': 'Yükleniyor...',
        'pos': 'poz',
        'neg': 'neg',
    },

    en: {
        'last-update': 'Last:',
        'auto': 'Auto',
        'paused': 'Paused',

        'total-market-cap': 'Total Market Cap',
        '24h-volume': '24h Volume',
        'btc-dominance-label': 'BTC Dominance',
        'fear-greed-label': 'Fear & Greed',

        'trading-signals': 'Trading Signals (Top 15)',
        '4-layer': '4-Layer Composite',
        'th-coin': 'Coin',
        'th-price': 'Price',
        'th-24h': '24h',
        'th-signal': 'Signal',
        'th-score': 'Score',
        'th-rsi': 'RSI',
        'th-layers': 'Layers',
        'loading-signals': 'Loading signals...',

        'derivatives': 'Derivatives',
        'th-symbol': 'Symbol',
        'th-funding': 'Funding',
        'th-ls': 'L/S',
        'th-oi': 'OI',

        'chart-legend-ema9': 'EMA 9',
        'chart-legend-ema21': 'EMA 21',
        'chart-legend-bb': 'BB',

        'top-movers': 'Top Movers',
        'gainers': 'Gainers',
        'losers': 'Losers',

        'volume-anomalies': 'Volume Anomalies',
        'no-anomalies': 'No anomalies detected',

        'news-sentiment': 'News Sentiment',

        'all-coins': 'All Coins (Top 50)',
        'search-placeholder': 'Search coin...',
        'th-rank': '#',
        'th-1h': '1h',
        'th-7d': '7d',
        'th-7d-chart': '7d Chart',
        'th-volume': 'Volume',
        'th-market-cap': 'Market Cap',
        'loading-coins': 'Loading coins...',

        'footer-text': 'BedavaFinans Signal Dashboard',
        'footer-data': 'Data:',
        'footer-refresh': 'Auto-refresh: 2 min',

        'strong-buy': 'STRONG BUY',
        'buy': 'BUY',
        'neutral': 'NEUTRAL',
        'sell': 'SELL',
        'strong-sell': 'STRONG SELL',
        'no-data': 'NO DATA',

        'high': 'High',
        'medium': 'Medium',
        'low': 'Low',

        'bullish': 'Bullish',
        'slightly-bullish': 'Slightly Bullish',
        'neutral-sent': 'Neutral',
        'slightly-bearish': 'Slightly Bearish',
        'bearish': 'Bearish',

        'extreme-fear': 'Extreme Fear',
        'fear': 'Fear',
        'neutral-fg': 'Neutral',
        'greed': 'Greed',
        'extreme-greed': 'Extreme Greed',

        'very-bullish': 'Very Bullish',
        'very-bearish': 'Very Bearish',

        'whale-loading': 'Whale data loading...',

        'watchlist': 'Watchlist',
        'watchlist-filter-title': 'Filter watchlist',

        'toggle-theme': 'Toggle theme',

        'data-refreshed': 'Data refreshed',
        'refresh-error': 'Refresh error',
        'alert-prompt': 'Enter target price ($):',

        'loading': 'Loading...',
        'pos': 'pos',
        'neg': 'neg',
    }
};

let currentLang = localStorage.getItem('bedavafinans-lang') || 'tr';

function t(key) {
    return TRANSLATIONS[currentLang]?.[key] || TRANSLATIONS['en']?.[key] || key;
}

function setLang(lang) {
    currentLang = lang;
    localStorage.setItem('bedavafinans-lang', lang);
    applyTranslations();
    updateLangButton();
}

function toggleLang() {
    setLang(currentLang === 'tr' ? 'en' : 'tr');
    // Re-render dynamic content
    if (typeof loadAll === 'function') {
        renderDynamicContent();
    }
}

function applyTranslations() {
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        const text = t(key);
        if (el.tagName === 'INPUT') {
            el.placeholder = text;
        } else {
            el.textContent = text;
        }
    });
    document.querySelectorAll('[data-i18n-title]').forEach(el => {
        el.title = t(el.getAttribute('data-i18n-title'));
    });
}

function updateLangButton() {
    const btn = document.getElementById('lang-toggle');
    if (btn) {
        btn.textContent = currentLang === 'tr' ? 'EN' : 'TR';
        btn.title = currentLang === 'tr' ? 'Switch to English' : 'Türkçeye geç';
    }
}

function translateSignal(signal) {
    const map = {
        'STRONG BUY': t('strong-buy'),
        'BUY': t('buy'),
        'NEUTRAL': t('neutral'),
        'SELL': t('sell'),
        'STRONG SELL': t('strong-sell'),
        'NO DATA': t('no-data'),
    };
    return map[signal] || signal;
}

function translateConfidence(confidence) {
    const map = {
        'High': t('high'),
        'Medium': t('medium'),
        'Low': t('low'),
    };
    return map[confidence] || confidence;
}

function translateFearGreed(classification) {
    const map = {
        'Extreme Fear': t('extreme-fear'),
        'Fear': t('fear'),
        'Neutral': t('neutral-fg'),
        'Greed': t('greed'),
        'Extreme Greed': t('extreme-greed'),
    };
    return map[classification] || classification;
}

function translateSentiment(label) {
    const map = {
        'Bullish': t('bullish'),
        'Slightly Bullish': t('slightly-bullish'),
        'Neutral': t('neutral-sent'),
        'Slightly Bearish': t('slightly-bearish'),
        'Bearish': t('bearish'),
    };
    return map[label] || label;
}

function translateMarketScore(label) {
    const map = {
        'Very Bullish': t('very-bullish'),
        'Bullish': t('bullish'),
        'Neutral': t('neutral-sent'),
        'Bearish': t('bearish'),
        'Very Bearish': t('very-bearish'),
    };
    return map[label] || label;
}
